---
import Layout from "../layouts/Layout.astro";
import BlogPreview from "../components/BlogPreview.astro";

export interface BlogFrontmatter {
  description: string;
  pubDate?: string;
}

const allBlogs = (
  await Astro.glob<BlogFrontmatter>("../pages/blog/*.mdx")
).filter((post) => post.frontmatter.pubDate);
---

<Layout title="Arhan's Blog" sshUser="blog">
  <div id="max-width-wrapper" class="input-mono">
    <h1>My blog</h1>
    {
      allBlogs
        .sort(
          (a, b) =>
            new Date(b.frontmatter.pubDate!).getTime() -
            new Date(a.frontmatter.pubDate!).getTime()
        )
        .map((blog, i) => (
          <BlogPreview
            pubDate={new Date(blog.frontmatter.pubDate!).toLocaleDateString(
              "en-US",
              {
                year: "2-digit",
                month: "numeric",
                day: "numeric",
              }
            )}
            title={blog.url!.split("/").at(-1)!}
            description={blog.frontmatter.description}
            url={(() => {
              const split = blog.url!.split("/");
              split[split.length - 1] = split[split.length - 1]
                .toLowerCase()
                .replaceAll(" ", "-");
              return split.join("/");
            })()}
            colorDotRed={i % 2 === 0}
            first={i === 0}
            last={i === allBlogs.length - 1}
          />
        ))
    }
  </div>
</Layout>

<style lang="scss">
  h1 {
    display: inline-block;
    padding-top: 6px;
    padding-bottom: 6px;
    border-top: 4px solid var(--lr);
    border-bottom: 4px solid var(--lb);
    margin-bottom: 50px;
  }
</style>
